function reloadIconList(){$.getJSON(window.API_BASE+'/containers',function(data){$('.services').html(Handlebars.templates['iconlist.hbs'](response.data));containerStats();setTimeout(reloadIconList,15000)})}function reloadBookmarks(){$.getJSON(window.API_BASE+'/bookmarks',function(data){$('.bookmarks').html(Handlebars.templates['bookmarks.hbs'](response.data));setTimeout(reloadBookmarks,60000)})}function formatBytes(bytes,decimals=2){if(!+bytes)return'0 Bytes';var k=1024,sizes=['Bytes','KiB','MiB','GiB','TiB','PiB','EiB','ZiB','YiB'],i=~~Math.log(bytes)/Math.log(k);return`${parseFloat((bytes/Math.pow(k,i)).toFixed(decimals<0?0:decimals))} ${sizes[i]}`}function containerStats(){$('.containerstats').each((i,ctl)=>{$.getJSON(window.API_BASE+'containers/'+$(ctl).attr('container-id')+'/stats',function(data){var cpuPercent=new Intl.NumberFormat('default', {style:'percent',minimumFractionDigits:2,maximumFractionDigits:2}).format(data.cpuPercent),memUsage=formatBytes(data.memory_stats.usage);$(ctl).html('CPU '+cpuPercent+', MEM '+memUsage)})})}function renderFeeds(target,data,template){var itemCount=data.map(a=>a.items.length+1).reduce((a,b)=>a+b),tickerDelay=itemCount*5;template=='ticker.hbs'&&($('.ticker').css('-webkit-animation-duration',`${tickerDelay}s`),$('.ticker').css('animation-duration',`${tickerDelay}s`));target.html(Handlebars.templates[template]({feeds:data,feedCount:itemCount,tickerDelay:tickerDelay}))}function loadFeeds(){var url=window.API_BASE+'/rss/feeds/ticker';$.getJSON(url,function(data){renderFeeds('footer',data.feeds,'ticker.hbs')});url=window.API_BASE+'/rss/feeds/feeds';$.getJSON(url,function(data){renderFeeds('#tabfeeds',data.feeds,'feeds.hbs')});setTimeout(loadFeeds,60000)}
